ARG boost_version=latest
FROM build_env_boost_debug:${boost_version}

MAINTAINER Francis Duffy
LABEL Description="Build zlib debug."

# Argument for number of cores to use while building
ARG num_cores

# Exclusions are performed by .dockerignore
COPY . /lib_src/zlib

RUN cd /lib_src/zlib \
  && find -regex ".*\.\(sh\|in\|ac\|am\)" -exec dos2unix {} ';' \
  && dos2unix configure \
  && CFLAGS="-O0 -g" ./configure --debug \
  && make -j ${num_cores} \
  && make install \
  && cd / \
  && ldconfig

CMD bash
